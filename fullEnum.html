<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>p5.js-Seite</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body>
<script>
    var cities = [];
    var totalCities = 13;

    var recordDistance;
    var bestEver;

    function setup() {
        createCanvas(800, 600);
        for (var i = 0; i < totalCities; i++) {
            var v = createVector(random(width), random(height));
            cities[i] = v;
        }

        var d = calcDistance(cities);
        recordDistance = d;
        bestEver = cities.slice();

    }

    function drawTour(tour, strokeC, strokeW) {
        stroke(strokeC);
        strokeWeight(strokeW);
        noFill();
        beginShape();
        for (let i = 0; i < tour.length; i++) {
            vertex(tour[i].x, tour[i].y);
        }
        // Zeichne eine Linie zurück zum Startpunkt, um den Kreis zu schließen
        vertex(tour[0].x, tour[0].y);
        endShape();
    }

    function draw() {
        background(0);
        fill(255);
        for (var i = 0; i < cities.length; i++) {
            ellipse(cities[i].x, cities[i].y, 8, 8);
        }

        // Zeichnet aktuellen Pfad
        drawTour(cities, color(255), 1);

        // Zeichnet die beste jemals gefundene Tour, und kehrt zum Startpunkt zurück
        drawTour(bestEver, color(255, 0, 255), 4);

        var i = floor(random(cities.length));
        var j = floor(random(cities.length));
        swap(cities, i, j);

        var d = calcDistance(cities);
        if (d < recordDistance) {
            recordDistance = d;
            bestEver = cities.slice();
        }
    }

    function swap(a, i, j) {
        var temp = a[i];
        a[i] = a[j];
        a[j] = temp;
    }


    function calcDistance(points) {
        var sum = 0;
        for (var i = 0; i < points.length - 1; i++) {
            var d = dist(points[i].x, points[i].y, points[i + 1].x, points[i + 1].y);
            sum += d;
        }

        // Addiere die Distanz vom letzten Punkt zurück zum ersten Punkt
        sum += dist(points[points.length - 1].x, points[points.length - 1].y, points[0].x, points[0].y);
        return sum;
    }
</script>
</body>
</html>
